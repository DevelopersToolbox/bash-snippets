#!/usr/bin/env bash

# -------------------------------------------------------------------------------- #
# Description                                                                      #
# -------------------------------------------------------------------------------- #
# This is a script to check if your script attached to in a terminal or not.       #
# -------------------------------------------------------------------------------- #

# -------------------------------------------------------------------------------- #
# in_terminal                                                                      #
# -------------------------------------------------------------------------------- #
# Returns true if we are attached to a terminal or false if not.                   #
# -------------------------------------------------------------------------------- #

function in_terminal()
{
    [[ -t 1 ]] && return 0 || return 1;
}

# -------------------------------------------------------------------------------- #
# in_pipe                                                                          #
# -------------------------------------------------------------------------------- #
# Returns true if we are attached to a pipe or false if not.                       #
# -------------------------------------------------------------------------------- #

function in_pipe()
{
    [[ -p /dev/stdout ]] && return 0 || return 1;
}

# -------------------------------------------------------------------------------- #
# in_redirection                                                                   #
# -------------------------------------------------------------------------------- #
# Returns true if we are attached to a redirection or false if not.                #
# -------------------------------------------------------------------------------- #

function in_redirection()
{
    [[ ! -t 1 && ! -p /dev/stdout ]] && return 0 || return 1;
}

# -------------------------------------------------------------------------------- #
# Run Tests                                                                        #
# -------------------------------------------------------------------------------- #
# A VERY simple test function to ensure that it all works                          #
# -------------------------------------------------------------------------------- #

function run_test()
{
    in_terminal && echo 'STDOUT is attached to TTY'

    in_pipe && echo 'STDOUT is attached to a pipe'

    in_redirection && echo 'STDOUT is attached to a redirection'
}

# -------------------------------------------------------------------------------- #
# Main()                                                                           #
# -------------------------------------------------------------------------------- #
# This is the actual 'script' and the functions/sub routines are called in order.  #
# -------------------------------------------------------------------------------- #

run_test

# -------------------------------------------------------------------------------- #
# End of Script                                                                    #
# -------------------------------------------------------------------------------- #
# This is the end - nothing more to see here.                                      #
# -------------------------------------------------------------------------------- #
