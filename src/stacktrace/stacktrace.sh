#!/usr/bin/env bash

# -------------------------------------------------------------------------------- #
# Description                                                                      #
# -------------------------------------------------------------------------------- #
# This is a simple script to generate a stack trace.                               #
# -------------------------------------------------------------------------------- #
# shellcheck disable=2120

function stacktrace
{
    local start_from=${1:-0}
    local i=0

    while caller $i > /dev/null
    do
        if (( "$i" + 1 >= "${start_from}" )); then
            caller $i
        fi
        ((i=i+1))
    done
}

function test_wrapper()
{
    stacktrace
}

# -------------------------------------------------------------------------------- #
# Run Tests                                                                        #
# -------------------------------------------------------------------------------- #
# A VERY simple test function to ensure that it all works                          #
# -------------------------------------------------------------------------------- #

function run_test()
{
    test_wrapper
}

# -------------------------------------------------------------------------------- #
# Main()                                                                           #
# -------------------------------------------------------------------------------- #
# This is the actual 'script' and the functions/sub routines are called in order.  #
# -------------------------------------------------------------------------------- #

run_test "$@"

# -------------------------------------------------------------------------------- #
# End of Script                                                                    #
# -------------------------------------------------------------------------------- #
# This is the end - nothing more to see here.                                      #
# -------------------------------------------------------------------------------- #

